<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta property="og:image" content="recursos/social.png">
    <meta property="og:description" content="Genera y descarga gratis tu código QR para tu URL, WhatsApp, Menú Digital (Restaurantes), Teléfono o WiFi">
    <meta property="og:title" content="Generador de Código QR Gratis Online para URL, WhatsApp, Menú Digital y más">
    <meta property="og:site_name" content="Haz tu Código QR, Generador de Código QR Online Gratis">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@fernandodilland">
    <meta name="twitter:title" content="Generador de Código QR Gratis Online para URL, WhatsApp, Menú y más">
    <meta name="twitter:description" content="Genera y descarga gratis tu código QR para tu URL, WhatsApp, Menú Digital (Restaurantes), Teléfono o WiFi">
    <meta name="twitter:image" content="recursos/social2.png">
    <link rel="icon" href="recursos/favicon.png">
    
    <title>Generador de Códigos QR Gratis, WhatsApp, Links</title>

    <link href="recursos/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="recursos/detalles.css">
    <link rel="stylesheet" href="recursos/animated.css">
    <link rel="stylesheet" href="recursos/owl.css">

    <style>
       .qr {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 50px;
            width: 100%;
        }

        .download-button {
            text-align: center;
            margin-top: 20px;
            max-width: 250px;
            margin: 0 auto;
        }

        .qr-canvas-wrapper {
            max-width: 800px;
            max-height: 800px;
            margin: 0 auto;
        }

        /* Espaciado entre botones de tipo QR */
        .type-btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem 0.75rem; /* vertical horizontal */
            margin-bottom: 1rem;
        }
        .type-btn-group .btn {
            min-width: 120px;
            margin: 0;
        }

        @font-face {
            font-family: 'Poppins';
            src: url('recursos/Poppins-Regular.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: 'Poppins';
            src: url('recursos/Poppins-SemiBold.ttf') format('truetype');
            font-weight: bold;
            font-style: normal;
        }

        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .main-banner {
            flex: 1 0 auto;
        }

        footer {
            flex-shrink: 0;
        }

        #share-toast {
          background: linear-gradient(90deg, #27ae60 0%, #2ecc71 100%);
          color: #fff;
          box-shadow: 0 4px 24px 0 rgba(39, 174, 96, 0.15);
          border-radius: 0.75rem;
          font-size: 1rem;
          border: none;
          opacity: 0.97;
          transition: box-shadow 0.2s;
        }
        #share-toast .toast-body {
          font-weight: 500;
          letter-spacing: 0.01em;
        }
        #share-toast .btn-close {
          filter: invert(1) grayscale(1) brightness(2);
        }
    </style>
  </head>
<body>
  <div class="main-banner" id="top">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="row">
            <div class="col-lg-6 align-self-center">
              <div class="left-content header-text">
                <h2>Haz tu <em>Código QR</em></h2>
                <br>
                <div class="container">
                  <div class="options" hidden>
                      <label>Seleccione el tipo de código QR:</label><br>
                      <div id="type-btn-group" class="type-btn-group" role="group">
                          <button type="button" class="btn btn-outline-primary active" data-type="url" onclick="selectQRType(this)"><i class="fas fa-link"></i> URL</button>
                          <button type="button" class="btn btn-outline-primary" data-type="whatsapp" onclick="selectQRType(this)"><i class="fab fa-whatsapp"></i> WhatsApp</button>
                          <button type="button" class="btn btn-outline-primary" data-type="drive" onclick="selectQRType(this)"><i class="fas fa-folder-open"></i> Menú digital</button>
                          <button type="button" class="btn btn-outline-primary" data-type="sms" onclick="selectQRType(this)"><i class="fas fa-comment-alt"></i> SMS</button>
                          <button type="button" class="btn btn-outline-primary" data-type="phone" onclick="selectQRType(this)"><i class="fas fa-phone"></i> Teléfono</button>
                          <button type="button" class="btn btn-outline-primary" data-type="text" onclick="selectQRType(this)"><i class="fas fa-font"></i> Texto</button>
                          <button type="button" class="btn btn-outline-primary" data-type="location" onclick="selectQRType(this)"><i class="fas fa-map-marker-alt"></i> Geolocalización</button>
                          <button type="button" class="btn btn-outline-primary" data-type="wifi" onclick="selectQRType(this)"><i class="fas fa-wifi"></i> WiFi</button>
                          <button type="button" class="btn btn-outline-primary" data-type="maps" onclick="selectQRType(this)"><i class="fas fa-map"></i> Google Maps</button>
                      </div>
                      <input type="hidden" id="type" name="type" value="url">
                      <label for="content">Ingrese la información:</label><br>
                      <input class="form-control" type="text" id="content" name="content" placeholder="https://"><br>
                      <div id="additional-fields"></div>
                      <label for="size">Seleccione un tamaño:</label><br>
                      <select class="form-control" id="size" name="size">
                          <option value="100x100">100x100</option>
                          <option value="200x200">200x200</option>
                          <option value="300x300" selected >300x300</option>
                          <option value="500x500">500x500</option>
                      </select><br>
                      <button class="btn btn-primary" onclick="generateQRCode()">Generar código QR</button>
                  </div>
              </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="right-image">
                <div class="qr">
                  <div class="qr-canvas-wrapper">
                      <canvas id="qr-canvas"></canvas>
                  </div>
              </div>
              <div class="download-button row g-2 justify-content-center">
                  <div class="col-12 col-md-6 d-grid">
                    <a id="download-link" class="btn btn-primary" href="#" download="qr.png" style="display: none;"><i class="fas fa-download"></i> Descargar</a>
                  </div>
                  <div class="col-12 col-md-6 d-grid">
                    <button id="share-link" class="btn btn-outline-secondary" style="display: none;" onclick="copyShareURL(event)"><i class="fas fa-share"></i> Compartir</button>
                  </div>
              </div>
              <div id="share-url-container" class="mt-2" style="display:none;">
                <input id="share-url" class="form-control text-center" readonly style="font-size:0.95rem;" />
              </div>
              <div id="share-toast" class="toast align-items-center text-bg-success border-0 position-fixed bottom-0 end-0 m-3" role="alert" aria-live="assertive" aria-atomic="true" style="z-index:9999; min-width:220px; display:none; white-space:nowrap;">
                <div class="d-flex align-items-center">
                  <div class="toast-body p-2">
                    <i class="fas fa-check-circle me-2"></i>El enlace se ha copiado exitosamente
                  </div>
                  <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close" onclick="hideShareToast()"></button>
                </div>
              </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-12 wow fadeIn">
          <p>Genera tu código QR para URL, WhatsApp, Menú Digital, Teléfono, Texto, Geolocalización, Google Maps y Wi-Fi.
          <br>Creado por: <a rel="nofollow" href="https://fernandodilland.com" target="_parent">Fernando Dilland</a>, código fuente: <a rel="nofollow" href="https://github.com/fernandodilland/hazqr" target="_parent">GitHub</a>.
        </p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="recursos/vendor/jquery/jquery.min.js"></script>
  <script src="recursos/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="recursos/owl-carousel.js"></script>
  <script src="recursos/animation.js"></script>
  <script src="recursos/imagesloaded.js"></script>
  <script src="recursos/detalles.js"></script>
  <script src="recursos/qrious.min.js"></script>
  <!-- Script para generación de Código QR -->
  <script>
    // Función para generar el código QR
    function generateQRCode() {
        var typeSelect = document.getElementById("type");
        var contentInput = document.getElementById("content");
        var additionalFields = document.getElementById("additional-fields");
        var qrCodeCanvas = document.getElementById("qr-canvas");
        var downloadLink = document.getElementById("download-link");

        var content = contentInput.value;
        var size = document.getElementById("size").value;

        var qr = new QRious({
            element: qrCodeCanvas,
            value: generateQRValue(),
            size: parseInt(size.split("x")[0]),
        });

        downloadLink.href = qr.toDataURL();
        downloadLink.style.display = "block";

        // Mostrar el botón de compartir cuando se genera el QR y actualizar su enlace
        var shareLink = document.getElementById("share-link");
        shareLink.dataset.url = generateShareURL();
        shareLink.style.display = "block";
        shareLink.innerHTML = '<i class="fas fa-share"></i> Compartir';
        var downloadLink = document.getElementById("download-link");
        downloadLink.innerHTML = '<i class="fas fa-download"></i> Descargar';
    }

    // Genera la URL para compartir el QR con los datos actuales
    function generateShareURL() {
        var type = document.getElementById('type').value;
        var hash = '#' + type;
        var params = [];
        var content = document.getElementById('content').value;
        if (content) params.push('1=' + encodeURIComponent(content));
        var additionalFields = document.getElementById('additional-fields');
        // Según el tipo, agregar los campos adicionales
        switch (type) {
            case 'whatsapp':
                var msg = additionalFields.querySelector('#whatsapp-message')?.value;
                if (msg) params.push('2=' + encodeURIComponent(msg));
                break;
            case 'sms':
                var msg = additionalFields.querySelector('#sms-message')?.value;
                if (msg) params.push('2=' + encodeURIComponent(msg));
                break;
            case 'location':
                var lng = additionalFields.querySelector('#location-longitude')?.value;
                if (lng) params.push('2=' + encodeURIComponent(lng));
                break;
            case 'wifi':
                var pwd = additionalFields.querySelector('#wifi-password')?.value;
                var sec = additionalFields.querySelector('#wifi-security')?.value;
                if (pwd) params.push('2=' + encodeURIComponent(pwd));
                if (sec) params.push('3=' + encodeURIComponent(sec));
                break;
        }
        // Tamaño
        var size = document.getElementById('size').value;
        if (size) params.push('s=' + encodeURIComponent(size));
        var url = window.location.origin + window.location.pathname + hash;
        if (params.length > 0) url += '&' + params.join('&');
        return url;
    }

    // Función para generar el valor del código QR en base al tipo seleccionado
    function generateQRValue() {
        var type = document.getElementById('type').value;
        var contentInput = document.getElementById('content');
        var additionalFields = document.getElementById('additional-fields');
        switch (type) {
            case "url":
                return addHTTPProtocol(contentInput.value);
            case "whatsapp":
                var phoneNumber = contentInput.value;
                var message = additionalFields.querySelector("#whatsapp-message")?.value;
                return generateWhatsAppLink(phoneNumber, message);
            case "sms":
                var phoneNumber = contentInput.value;
                var message = additionalFields.querySelector("#sms-message")?.value;
                return generateSMSLink(phoneNumber, message);
            case "phone":
                return "tel:" + contentInput.value;
            case "text":
                return contentInput.value;
            case "location":
                var latitude = contentInput.value;
                var longitude = additionalFields.querySelector("#location-longitude")?.value;
                return generateGeoLocationLink(latitude, longitude);
            case "wifi":
                var wifiName = contentInput.value;
                var wifiPassword = additionalFields.querySelector("#wifi-password")?.value;
                var wifiSecurity = additionalFields.querySelector("#wifi-security")?.value;
                return generateWifiLink(wifiName, wifiPassword, wifiSecurity);
            case "drive":
                return contentInput.value;
            case "maps":
                return generateGoogleMapsLink(contentInput.value);
            default:
                return addHTTPProtocol(contentInput.value);
        }
    }

    // Función para cambiar el marcador de posición según el tipo seleccionado
    function changePlaceholder() {
        var type = document.getElementById('type').value;
        var contentInput = document.getElementById('content');
        var additionalFields = document.getElementById('additional-fields');
        switch (type) {
            case "url":
                contentInput.placeholder = "Dirección URL";
                additionalFields.innerHTML = "";
                break;
            case "whatsapp":
                contentInput.placeholder = "Número de WhatsApp";
                additionalFields.innerHTML = `
                    <input type="text" class="form-control" id="whatsapp-message" name="whatsapp-message" placeholder="Mensaje (opcional)"><br>
                `;
                break;
            case "sms":
                contentInput.placeholder = "Número de teléfono";
                additionalFields.innerHTML = `
                    <input type="text" class="form-control" id="sms-message" name="sms-message" placeholder="Mensaje"><br>
                `;
                break;
            case "phone":
                contentInput.placeholder = "Ingresa el número de teléfono";
                additionalFields.innerHTML = "";
                break;
            case "text":
                contentInput.placeholder = "Ingresa el texto";
                additionalFields.innerHTML = "";
                break;
            case "location":
                contentInput.placeholder = "Latitud";
                additionalFields.innerHTML = `
                    <input type="text" class="form-control" id="location-longitude" name="location-longitude" placeholder="Longitud"><br>
                `;
                break;
            case "wifi":
                contentInput.placeholder = "Nombre de la red";
                additionalFields.innerHTML = `
                    <input type="text" class="form-control" id="wifi-password" name="wifi-password" placeholder="Contraseña"><br>
                    <select class="form-control" id="wifi-security" name="wifi-security">
                        <option value="WPA">WPA</option>
                        <option value="WEP">WEP</option>
                        <option value="Ninguna">Ninguna</option>
                    </select><br>
                `;
                break;
            case "drive":
                contentInput.placeholder = "https://drive.google.com/drive/folders/...";
                additionalFields.innerHTML = "";
                break;
            case "maps":
                contentInput.placeholder = "Dirección";
                additionalFields.innerHTML = "";
                break;
            default:
                contentInput.placeholder = "Dirección URL";
                additionalFields.innerHTML = "";
                break;
        }
    }

    // Función para agregar el protocolo HTTP a una URL si no está presente
    function addHTTPProtocol(url) {
        if (url && !url.match(/^https?:\/\//i)) {
            url = "http://" + url;
        }
        return url;
    }

    // Función para generar el enlace de WhatsApp
    function generateWhatsAppLink(phoneNumber, message) {
        var link = "https://wa.me/" + phoneNumber.replace(/[^\d.]/g, "");
        if (message) {
            link += "?text=" + encodeURIComponent(message);
        }
        return link;
    }

    // Función para generar el enlace de mensaje de texto SMS
    function generateSMSLink(phoneNumber, message) {
        var link = "sms:" + phoneNumber.replace(/[^\d.]/g, "");
        if (message) {
            link += "&body=" + encodeURIComponent(message);
        }
        return link;
    }

    // Función para generar el enlace de geolocalización
    function generateGeoLocationLink(latitude, longitude) {
        return "geo:" + encodeURIComponent(latitude) + "," + encodeURIComponent(longitude) + ",500";
    }

    // Función para generar el enlace de red WiFi
    function generateWifiLink(name, password, security) {
        var link = "WIFI:S:" + encodeURIComponent(name) + ";";
        if (password) {
            link += "T:" + security + ";P:" + encodeURIComponent(password) + ";;";
        } else {
            link += "T:" + security + ";;";
        }
        return link;
    }

    // Función para generar el enlace de Google Maps
    function generateGoogleMapsLink(address) {
        return "https://www.google.com/maps/search/" + encodeURIComponent(address);
    }

    // --- INICIO: Sincronizar select con hash de la URL ---
    // Actualiza el hash al cambiar la opción
    document.addEventListener('DOMContentLoaded', function() {
        var type = 'url';
        var hash = window.location.hash.replace('#', '');
        var btns = document.querySelectorAll('#type-btn-group button');
        var options = document.querySelector('.options');
        if (options) {
            options.hidden = false;
        }
        if (hash) {
            var btn = Array.from(btns).find(b => b.getAttribute('data-type') === hash);
            if (btn) {
                selectQRType(btn);
                type = hash;
            }
        }
        // Enfocar automáticamente el campo de información al cargar la página
        var contentInput = document.getElementById('content');
        if (contentInput) {
            contentInput.focus();
        }
    });
    // --- FIN: Sincronizar select con hash de la URL ---

    // --- NUEVO: Manejo de botones para tipo de QR ---
    function selectQRType(btn) {
        // Quitar la clase 'active' de todos los botones
        var btns = document.querySelectorAll('#type-btn-group button');
        btns.forEach(function(b) { b.classList.remove('active'); });
        // Agregar la clase 'active' al botón seleccionado
        btn.classList.add('active');
        // Actualizar el valor oculto
        document.getElementById('type').value = btn.getAttribute('data-type');
        changePlaceholder();
        // Actualizar el hash de la URL
        window.location.hash = '#' + btn.getAttribute('data-type');
        // Enfocar el campo principal
        var contentInput = document.getElementById('content');
        if (contentInput) {
            contentInput.focus();
        }
    }
    // --- NUEVO: Llenar campos desde la URL si hay parámetros ---
    document.addEventListener('DOMContentLoaded', function() {
        // ...existing code...
        // --- NUEVO: Llenar campos desde la URL si hay parámetros ---
        var hash = window.location.hash;
        if (hash && hash.includes('&')) {
            var [mainHash, ...paramParts] = hash.slice(1).split('&');
            var params = {};
            paramParts.forEach(function(p) {
                var [k, v] = p.split('=');
                params[k] = decodeURIComponent(v || '');
            });
            // Seleccionar tipo
            var btns = document.querySelectorAll('#type-btn-group button');
            var btn = Array.from(btns).find(b => b.getAttribute('data-type') === mainHash);
            if (btn) selectQRType(btn);
            // Llenar campos
            setTimeout(function() {
                if (params['1']) document.getElementById('content').value = params['1'];
                var type = mainHash;
                var additionalFields = document.getElementById('additional-fields');
                switch (type) {
                    case 'whatsapp':
                        if (params['2']) additionalFields.querySelector('#whatsapp-message').value = params['2'];
                        break;
                    case 'sms':
                        if (params['2']) additionalFields.querySelector('#sms-message').value = params['2'];
                        break;
                    case 'location':
                        if (params['2']) additionalFields.querySelector('#location-longitude').value = params['2'];
                        break;
                    case 'wifi':
                        if (params['2']) additionalFields.querySelector('#wifi-password').value = params['2'];
                        if (params['3']) additionalFields.querySelector('#wifi-security').value = params['3'];
                        break;
                }
                if (params['s']) document.getElementById('size').value = params['s'];
                generateQRCode();
            }, 100); // Espera breve para que los campos existan
        }
    });
    function copyShareURL(e) {
        e.preventDefault();
        var shareLink = document.getElementById("share-link");
        var url = shareLink.dataset.url;
        // Mostrar el enlace en el input
        var shareUrlContainer = document.getElementById('share-url-container');
        var shareUrlInput = document.getElementById('share-url');
        shareUrlInput.value = url;
        shareUrlContainer.style.display = 'block';
        // Cambiar el hash de la URL actual para que el enlace sea visible en la barra de direcciones
        if (window.location.hash !== url.split(window.location.pathname)[1]) {
            window.location.hash = url.split(window.location.pathname)[1];
        }
        if (navigator.clipboard) {
            navigator.clipboard.writeText(url).then(function() {
                showShareToast();
            });
        } else {
            // Fallback
            var temp = document.createElement('input');
            document.body.appendChild(temp);
            temp.value = url;
            temp.select();
            document.execCommand('copy');
            document.body.removeChild(temp);
            showShareToast();
        }
    }
    function showShareToast() {
        var toast = document.getElementById('share-toast');
        toast.style.display = 'block';
        toast.classList.add('show');
        setTimeout(function(){
            hideShareToast();
        }, 2500);
    }
    function hideShareToast() {
        var toast = document.getElementById('share-toast');
        toast.style.display = 'none';
        toast.classList.remove('show');
    }
  </script>

</body>
</html>